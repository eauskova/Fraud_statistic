1) Введение
    **Цель**: Цель данного проекта состоит в выявлении признаков, статистически отличающих мошеннические транзакции от обычных. Для анализа используется датасет, размещённый на платформе Kaggle в 2023 году, содержащий информацию о транзакциях по кредитным картам.
    **Описание данных**:
        V1–V28: анонимизированные признаки (PCA).
        Amount: сумма транзакции.
        Class: 0 — обычная, 1 — мошенническая
    **Задачи**:
        Провести предобработку и EDA.
        Применить статистические тесты для проверки различий между классами.
        Найти признаки, по которым можно отличать мошенничество.
        Сформулировать выводы и рекомендации.
    **Гипотезы**:
    H1: Между мошенническими и обычными транзакциями существуют статистически значимые различия по некоторым признакам (V1–V28, Amount).
    H2: Распределения признаков в обоих классах соответствуют нормальному распределению (для применения параметрических методов).
    H3: Признак Amount является важным фактором, отличающим мошеннические транзакции от обычных.
    H4: Все признаки (V1–V28) обладают различиями между классами и могут быть полезны для обнаружения фрода.

2) Импорт и первичная обработка данных
    2.1 *Загрузка и структура данных*
    Данные загружаются из CSV-файла. Первичный осмотр проводится с помощью метода `.info()` , чтобы получить информацию о типах данных, количестве признаков и общих статистиках.

    2.2 *Проверка пропущенных значений*
    С помощью метода `df.isnull().sum()` определяется наличие пропусков. В данном датасете пропущенные значения отсутствуют.

    2.3 *Удаление неинформативных признаков*
    Удаляются столбцы, не несущие полезной информации для анализа (например, id). Это делается с помощью метода `drop()` библиотеки pandas.

    2.4 *Проверка баланса классов*
    Проверка баланса классов нужна, чтобы убедиться, что в выборке представлено достаточное количество объектов каждого типа (например, фрод и не фрод). Если один класс сильно преобладает, это может исказить результаты анализа: модель будет игнорировать редкий класс, статистика — давать ложные выводы, а метрики — казаться высокими при полной неэффективности.
    Проводится с помощью команды `print(df['Class'].value_counts(normalize=True) * 100)`.
    Оказалось, что классы представлены поровну: по 284 315 наблюдений в каждом. Это соответствует 50% для класса 0 (обычные транзакции) и 50% для класса 1 (мошенничество), что говорит о полном балансе и позволяет проводить сравнение без дополнительных корректировок, таких как балансировка выборки.
   
3) Исследовательский анализ данных (EDA)
    Цель EDA — визуально выделить признаки, которые ведут себя по-разному у фрода и не фрода.
    На этом этапе проводится визуальное и описательное сравнение транзакций двух классов:
        - Гистограммы и boxplot для Amount для того чтобы понять, отличается ли сумма транзакции (Amount) у мошеннических и обычных операций.
        - Boxplot для признаков V1–V28.
        - Корреляционная матрица признаков (V1–V28, Amount).

    3.1 *После построения графиков*
    Анализ распределения суммы транзакций (Amount) по классам показал, что данные визуально распределены равномерно и практически одинаково как для обычных, так и для мошеннических операций. Форма распределения не демонстрирует значимых различий, что может указывать на слабое влияние признака Amount на различие между классами. Тем не менее, для подтверждения данного наблюдения необходима проверка с помощью статистических тестов.

    3.2 *Boxplot суммы транзакций (Amount) по классам*
    График показывает, что медианные значения, а также распределение суммы транзакций практически совпадают между обычными (0) и мошенническими (1) транзакциями. Существенных визуальных различий не наблюдается. Это подтверждает предыдущий вывод из гистограммы о возможной слабой информативности признака Amount.

    3.3 *Boxplot для признаков V1–V28*
    Для визуального анализа признаков был реализован цикл, автоматически строящий boxplot-графики по признакам V1–V28, сгруппированным по 4 на каждый график.
    Анализ графиков показал, что у большинства признаков отсутствуют выраженные различия в положении медиан, размахе и общей форме распределения между классами. Это может свидетельствовать о том, что значительная часть признаков не позволяет надёжно различать обычные и мошеннические транзакции на основании визуального анализа.
    Тем не менее, отдельные признаки — в частности, V9, V10, V11, V12, V14, V16, V18 — демонстрируют заметные отличия между классами по медиане и распределению значений. Эти признаки представляют интерес и будут использованы на следующем этапе — в статистическом анализе, направленном на проверку значимых различий между группами.
    
    3.4 *Корреляционная матрица признаков*
    Построенная корреляционная матрица показывает, что большинство признаков V1–V28 демонстрируют слабую взаимосвязь между собой. Это ожидаемо, поскольку данные были предварительно обработаны с использованием метода главных компонент (PCA), задача которого устранить корреляции между признаками.
    Тем не менее, на матрице можно выделить небольшие кластеры взаимосвязанных признаков, таких как V4, V10, V11, V12, V14, V16, V18, V21, V22. Между ними наблюдаются умеренные корреляции, как положительные, так и отрицательные, что может указывать на скрытые закономерности в структуре данных, несмотря на применение PCA. Эти связи могут быть полезны для дальнейшего анализа зависимости между признаками и поведения транзакций.
    Признак Amount не демонстрирует выраженной корреляции ни с одним из PCA-признаков, что подтверждает его независимость. Это делает его особенно интересным для последующего анализа как отдельного, возможно, значимого фактора, влияющего на вероятность мошенничества.
    Признак Amount не имеет выраженных корреляций с другими, что делает его независимым и потенциально полезным для анализа как самостоятельный фактор.

4) Статистический анализ признаков
    4.1 *Проверка нормальности распределения*
    Для проверки нормальности распределения был использован тест Колмогорова–Смирнова. Во всех классах большинство признаков, включая Amount, значимо отклоняются от нормального распределения (p < 0.05), что обосновывает использование непараметрических методов для дальнейшего анализа.

    4.2 *Сравнение групп*
    Для признака Amount был применён тест Манна–Уитни. Полученное значение p = 0.0882 не достигает статистической значимости (пороговое значение = 0.05), что указывает на отсутствие различий между мошенническими и обычными транзакциями по данному признаку. Это может свидетельствовать о низкой диагностической ценности Amount для классификации фрода

    Для оценки различий между мошенническими и обычными транзакциями были проверены признаки V1–V28 с использованием теста Колмогорова–Смирнова на нормальность, а затем — теста Манна–Уитни для сравнения классов.
    Анализ показал, что большинство признаков имеют ненормальное распределение (p-value < 0.05), что подтверждает обоснованность применения непараметрического теста. По результатам непараметрического теста Манна–Уитни, почти все признаки (V1–V27) демонстрируют статистически значимые различия между классами (p < 0.05). Исключение составляет признак V28, для которого различия незначимы, что может говорить о его низкой информативности для задачи классификации.
    Таким образом, можно сделать вывод, что признаки V1–V27 потенциально полезны для выявления мошенничества, а признак V28 — менее релевантен.

    4.3 *Доверительные интервалы*
    Для оценки различий между обычными и мошенническими транзакциями были рассчитаны 95% доверительные интервалы для средних значений признаков V25, V26, V27 и Amount.
    По признакам V25, V26, V27 наблюдаются чёткие различия между классами. Средние значения в классах противоположны по знаку (например, по V27: −0.214 для обычных транзакций и 0.214 для мошеннических), а интервалы практически не пересекаются. Это свидетельствует о статистически значимом различии и делает данные признаки потенциально полезными для задачи обнаружения фрода.
    В то же время, признак Amount, несмотря на высокое абсолютное значение среднего, демонстрирует почти одинаковые результаты для обоих классов: интервалы существенно перекрываются. Это указывает на отсутствие значимого различия в сумме транзакций между обычными и мошенническими случаями в данном датасете, что подтверждает ограниченную информативность признака Amount в контексте данной задачи.

5) Интерпретация результатов
    Анализ статистических различий между классами позволил выделить признаки, которые потенциально могут быть использованы для выявления мошеннических транзакций.
    Результаты теста Манна–Уитни показали, что почти все признаки (V1–V27) имеют статистически значимые различия между мошенническими и обычными транзакциями (p < 0.05). Это говорит о различии распределений по этим признакам между двумя классами.
    Исключение составляют V28 и Amount, по которым различия не являются статистически значимыми, что делает их менее полезными для классификации.
    Часть признаков показала особенно низкие значения p-value, что может указывать на их высокую чувствительность к целевой переменной.
    Среди признаков, для которых были дополнительно построены доверительные интервалы (V25–V27), наблюдаются чёткие различия между классами: средние значения противоположны по знаку и интервалы не пересекаются. Это подтверждает устойчивость различий и высокую информативность этих признаков.
    В то же время по признаку Amount доверительные интервалы существенно перекрываются, а средние значения близки, что подтверждает отсутствие значимых различий и низкую информативность.

    Полученные результаты позволяют сделать следующие выводы относительно поставленных гипотез. Гипотеза H1, предполагавшая наличие статистически значимых различий между классами по ряду признаков, подтверждается частично: различия действительно выявлены для большинства признаков (V1–V27), но отсутствуют для V28 и Amount. Гипотеза H2 о нормальности распределения признаков не подтвердилась — подавляющее большинство признаков не подчиняются нормальному распределению, что определило выбор непараметрических методов анализа. Также не подтвердилась гипотеза H3 — признак Amount не демонстрирует статистически значимых различий между классами и характеризуется широким пересечением доверительных интервалов. Наконец, гипотеза H4 о полезности всех признаков для задачи классификации подтверждается лишь частично: только признаки V1–V27 продемонстрировали информативность, тогда как V28 оказался статистически неразличимым и может быть исключён из дальнейшего анализа.
    Таким образом, можно сделать вывод, что признаки V1–V27 несут полезную информацию для задачи обнаружения фрода, особенно признаки с выраженным отличием средних и непересекающимися доверительными интервалами. Признаки V28 и Amount можно рассматривать как менее релевантные и, возможно, исключить из дальнейшего анализа или обучения модели.

    Перспективы и дальнейшие шаги:
    Использовать выявленные статистически значимые признаки для построения моделей машинного обучения.
    Провести отбор признаков на основе важности в модели.
    Расширить анализ за счёт кросс-валидации и оценки метрик качества классификации.
    Исследовать влияние масштабирования и трансформаций признаков на результаты моделей.